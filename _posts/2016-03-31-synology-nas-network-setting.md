---
title: 让你的群晖 NAS 安全地暴露到公网中
author: Dozer
layout: post
permalink: /2016/03/synology-nas-network-setting.html
categories:
  - 互联网
tags:
  - NAS
  - SSL
  - HTTPS
  - DDNS
  - 路由器
  - 光纤猫
---

### 群晖 NAS

家里的群晖 NAS 已经用了一年了，好话就不多说了，谁用谁知道。一年内成功安利了两位朋友买了群晖。（群晖是不是要给我点推广费？）

去年开始运营商网络挟持很猖狂，各种嵌入广告，国内互联网公司也都纷纷上了 HTTPS。

我一个个人 NAS 也不太可能被盯上，但是在这种网络情况下，只要有人针对你，那么挟持你的相关信息是分分钟的。

所以我也开始在自家的 NAS 上折腾 HTTPS 了。

除了这块的教程，我也顺便也把 NAS 如何暴露到公网相关的教程都写一下，包含了很多个部分：光线猫破解，光纤猫改桥接，端口转发设置，DDNS 设置，NAS 设置等。

暴露到公网后用起来就很方便了，再配合 HTTPS，基本不用担心安全问题了。

<!--more-->

&nbsp;

### 上海电信光纤猫破解和设置

#### 破解

我家已经用上了上海电信 200M 宽带，那速度…

因为多次升级带宽，家里的光纤猫也换过好几个了，光纤猫也是越来越难破解了。

其实，在上海的话非常简单，直接给电信打电话，说要超级管理员密码改桥接，电信就会联系你区域的维修师傅，他们会把密码给你的。

你可以找他们上门帮你改桥接，也可以自动动手改，其实改起来也非常简单。

其他地区是怎么个情况我不是很了解，总之需要想办法获得光纤猫的超级管理员权限，这样才能把家里的 NAS 暴露到公网中。

&nbsp;

#### 光纤猫和路由器的设置



&nbsp;

### 路由器端口转发

光纤猫改桥接，并由路由器拨号后，你的路由器就已经成功暴露到公网了。但是为了安全起见，外网当然是无法访问任何内网机器的。

这时候就需要配置端口转发了。

为什么要用端口转发而不用 DMZ 主机呢？因为用 DMZ 主机的话，相当于把整个 NAS 暴露到了公网，而你局域网内的其他机器就没什么机会出头了。

所以用端口转发的话就会更灵活一点，不同的端口给不同的机器。例如群晖 NAS 常用的端口是 5000, 5001, 80, 443 等，然后家里的 PS4 常用端口是 1935, 3478-3480。

然后如果局域网内还有机器在下 BT，它还可以利用 UPnP 协议向路由器申请临时的端口转发，非常灵活。

&nbsp;

端口转发在不同的路由器中配置方法不太一样，但非常简单，我这里就简单地截个图。另外，需要用端口转发的目标机器最好固定一下 IP，不要使用 DHCP，否则 IP 变了转发就失效了。

（此处需要截图）

&nbsp;

### DDNS

上面的步骤全部搞定后，网络就已经打通了。但是家里的宽带出口 IP 每次都会变，那解决方案当然也是有的，配置一个 DDNS 就行了。

DDNS 主要是在路由器中配置，家里的华硕路由器有免费的 DDNS 功能，最终会给你分配一个域名。另外国内的花生壳也可以有一个免费的 DDNS 域名，国内卖的路由器基本都支持花生壳。

有了一个免费的 DDNS 域名后，再到自己的域名中配置一个 CNAME 就可以了。

![DDNS](/uploads/2016/04/ddns.png)

这块有什么不明白的可以去网上搜教程，教程非常多。

&nbsp;

### 免费 SSL 证书

免费 SSL 证书有这几种方案：

* 自签发
* 
